# Xxwww
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åœ£è¯å¿«ä¹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            margin: 0;
            overflow: hidden;
            background: #000;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            touch-action: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        .container {
            position: relative;
            width: 100vw;
            height: 100vh;
        }
        
        #canvas {
            display: block;
            width: 100%;
            height: 100%;
        }
        
        .message {
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            text-align: center;
            color: #fff;
            font-size: 24px;
            text-shadow: 0 0 10px rgba(255, 105, 180, 0.8);
            z-index: 100;
            padding: 10px;
        }
        
        .instructions {
            position: absolute;
            bottom: 30px;
            left: 0;
            right: 0;
            text-align: center;
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            z-index: 100;
            padding: 10px;
        }
        
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 18px;
            z-index: 1000;
        }
        
        @media (max-width: 768px) {
            .message {
                font-size: 20px;
                top: 10px;
            }
            
            .instructions {
                font-size: 12px;
                bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="message">ğŸ„ Merry Christmas! ğŸ’–</div>
        <div class="instructions">ç”¨æ‰‹æŒ‡æ‹–åŠ¨æ—‹è½¬è§†è§’</div>
        <canvas id="canvas"></canvas>
        <div class="loading" id="loading">åŠ è½½ä¸­...</div>
    </div>
    
    <script>
        // ç®€åŒ–ç‰ˆThree.jsç²’å­åœ£è¯æ ‘ - é’ˆå¯¹ç§»åŠ¨è®¾å¤‡ä¼˜åŒ–
        (function() {
            'use strict';
            
            const canvas = document.getElementById('canvas');
            const loading = document.getElementById('loading');
            let gl = null;
            let isInitialized = false;
            
            // ç§»åŠ¨è®¾å¤‡æ£€æµ‹
            const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            
            // ç²’å­æ•°é‡ï¼ˆç§»åŠ¨è®¾å¤‡å‡å°‘æ•°é‡ï¼‰
            const PARTICLE_COUNT = isMobile ? 3000 : 5000;
            
            // åˆå§‹åŒ–WebGL
            function initWebGL() {
                try {
                    gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                    
                    if (!gl) {
                        throw new Error('WebGL not supported');
                    }
                    
                    // è®¾ç½®canvaså°ºå¯¸
                    resizeCanvas();
                    
                    // è®¾ç½®è§†å£
                    gl.viewport(0, 0, canvas.width, canvas.height);
                    
                    // æ¸…é™¤é¢œè‰²
                    gl.clearColor(0.0, 0.0, 0.0, 1.0);
                    
                    // å¯ç”¨æ·±åº¦æµ‹è¯•
                    gl.enable(gl.DEPTH_TEST);
                    
                    // å¯ç”¨æ··åˆï¼ˆç”¨äºé€æ˜æ•ˆæœï¼‰
                    gl.enable(gl.BLEND);
                    gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);
                    
                    isInitialized = true;
                    loading.style.display = 'none';
                    
                    // å¼€å§‹åŠ¨ç”»
                    requestAnimationFrame(animate);
                    
                } catch (e) {
                    console.error('WebGLåˆå§‹åŒ–å¤±è´¥:', e);
                    loading.innerHTML = 'è®¾å¤‡ä¸æ”¯æŒ3Dæ•ˆæœ<br>ç¥æ‚¨åœ£è¯å¿«ä¹ï¼ğŸ…';
                    loading.style.color = '#ff69b4';
                }
            }
            
            // è°ƒæ•´canvaså¤§å°
            function resizeCanvas() {
                const dpr = window.devicePixelRatio || 1;
                const rect = canvas.getBoundingClientRect();
                
                canvas.width = rect.width * dpr;
                canvas.height = rect.height * dpr;
                
                // è®¾ç½®CSSå¤§å°
                canvas.style.width = rect.width + 'px';
                canvas.style.height = rect.height + 'px';
                
                if (gl) {
                    gl.viewport(0, 0, canvas.width, canvas.height);
                }
            }
            
            // åˆ›å»ºç€è‰²å™¨ç¨‹åº
            function createShaderProgram(vertexShaderSource, fragmentShaderSource) {
                const vertexShader = gl.createShader(gl.VERTEX_SHADER);
                gl.shaderSource(vertexShader, vertexShaderSource);
                gl.compileShader(vertexShader);
                
                if (!gl.getShaderParameter(vertexShader, gl.COMPILE_STATUS)) {
                    console.error('é¡¶ç‚¹ç€è‰²å™¨ç¼–è¯‘é”™è¯¯:', gl.getShaderInfoLog(vertexShader));
                    return null;
                }
                
                const fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);
                gl.shaderSource(fragmentShader, fragmentShaderSource);
                gl.compileShader(fragmentShader);
                
                if (!gl.getShaderParameter(fragmentShader, gl.COMPILE_STATUS)) {
                    console.error('ç‰‡æ®µç€è‰²å™¨ç¼–è¯‘é”™è¯¯:', gl.getShaderInfoLog(fragmentShader));
                    return null;
                }
                
                const program = gl.createProgram();
                gl.attachShader(program, vertexShader);
                gl.attachShader(program, fragmentShader);
                gl.linkProgram(program);
                
                if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {
                    console.error('ç¨‹åºé“¾æ¥é”™è¯¯:', gl.getProgramInfoLog(program));
                    return null;
                }
                
                return program;
            }
            
            // åˆ›å»ºç²’å­æ•°æ®
            function createParticles() {
                const particles = [];
                
                // åœ£è¯æ ‘å‚æ•°
                const treeHeight = 5;
                const baseRadius = 2;
                const topRadius = 0.5;
                
                for (let i = 0; i < PARTICLE_COUNT; i++) {
                    const t = Math.random();
                    const height = t * treeHeight;
                    const radius = baseRadius - (baseRadius - topRadius) * (height / treeHeight);
                    const angle = Math.random() * Math.PI * 2;
                    
                    // ä½ç½®
                    const x = Math.cos(angle) * radius * (0.3 + Math.random() * 0.7);
                    const y = height - treeHeight / 2;
                    const z = Math.sin(angle) * radius * (0.3 + Math.random() * 0.7);
                    
                    // é¢œè‰²ï¼ˆç²‰è‰²æ¸å˜ï¼‰
                    const colorFactor = (height / treeHeight) * 0.7 + 0.3;
                    const r = 1.0;
                    const g = colorFactor;
                    const b = colorFactor;
                    
                    particles.push(x, y, z, r, g, b, 1.0);
                }
                
                // æ·»åŠ æ˜Ÿæ˜Ÿç²’å­
                for (let i = 0; i < 1000; i++) {
                    particles.push(
                        (Math.random() - 0.5) * 20,
                        (Math.random() - 0.5) * 20,
                        (Math.random() - 0.5) * 10 + 5,
                        1, 1, 1, Math.random() * 0.5 + 0.5
                    );
                }
                
                return new Float32Array(particles);
            }
            
            // ä¸»æ¸²æŸ“å¾ªç¯
            let time = 0;
            let rotationX = 0;
            let rotationY = 0;
            let isDragging = false;
            let lastX = 0;
            let lastY = 0;
            
            function animate(currentTime) {
                if (!isInitialized) return;
                
                time = currentTime * 0.001;
                
                // æ¸…é™¤ç”»å¸ƒ
                gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
                
                // è¿™é‡Œç®€åŒ–äº†WebGLæ¸²æŸ“é€»è¾‘
                // å®é™…å®ç°éœ€è¦å®Œæ•´çš„WebGLæ¸²æŸ“ç®¡çº¿
                
                requestAnimationFrame(animate);
            }
            
            // è§¦æ‘¸/é¼ æ ‡äº‹ä»¶å¤„ç†
            function setupControls() {
                // é¼ æ ‡äº‹ä»¶
                canvas.addEventListener('mousedown', (e) => {
                    isDragging = true;
                    lastX = e.clientX;
                    lastY = e.clientY;
                });
                
                canvas.addEventListener('mousemove', (e) => {
                    if (!isDragging) return;
                    
                    const deltaX = e.clientX - lastX;
                    const deltaY = e.clientY - lastY;
                    
                    rotationY += deltaX * 0.01;
                    rotationX += deltaY * 0.01;
                    
                    lastX = e.clientX;
                    lastY = e.clientY;
                });
                
                canvas.addEventListener('mouseup', () => {
                    isDragging = false;
                });
                
                canvas.addEventListener('mouseleave', () => {
                    isDragging = false;
                });
                
                // è§¦æ‘¸äº‹ä»¶
                canvas.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    isDragging = true;
                    lastX = e.touches[0].clientX;
                    lastY = e.touches[0].clientY;
                }, { passive: false });
                
                canvas.addEventListener('touchmove', (e) => {
                    e.preventDefault();
                    if (!isDragging) return;
                    
                    const deltaX = e.touches[0].clientX - lastX;
                    const deltaY = e.touches[0].clientY - lastY;
                    
                    rotationY += deltaX * 0.01;
                    rotationX += deltaY * 0.01;
                    
                    lastX = e.touches[0].clientX;
                    lastY = e.touches[0].clientY;
                }, { passive: false });
                
                canvas.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    isDragging = false;
                }, { passive: false });
            }
            
            // çª—å£å¤§å°è°ƒæ•´
            window.addEventListener('resize', resizeCanvas);
            
            // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
            window.addEventListener('DOMContentLoaded', () => {
                initWebGL();
                setupControls();
                
                // å¦‚æœ10ç§’åè¿˜åœ¨åŠ è½½ï¼Œæ˜¾ç¤ºå¤‡ç”¨ä¿¡æ¯
                setTimeout(() => {
                    if (loading.style.display !== 'none') {
                        loading.innerHTML = 'åŠ è½½è¾ƒæ…¢ï¼Œè¯·ç¨å€™...<br>ğŸ„åœ£è¯å¿«ä¹ï¼ğŸ…';
                    }
                }, 10000);
            });
            
            // å¤‡ç”¨æ–¹æ¡ˆï¼šå¦‚æœWebGLå¤±è´¥ï¼Œæ˜¾ç¤ºé™æ€æ•ˆæœ
            function showFallback() {
                loading.innerHTML = `
                    <div style="text-align: center; padding: 20px;">
                        <div style="font-size: 40px; margin-bottom: 20px;">ğŸ„</div>
                        <div style="font-size: 24px; margin-bottom: 10px; color: #ff69b4;">Merry Christmas!</div>
                        <div style="font-size: 16px; color: #fff; opacity: 0.8;">
                            æ„¿æ‚¨çš„åœ£è¯å……æ»¡çˆ±ä¸æ¬¢ä¹ ğŸ’–
                        </div>
                        <div style="margin-top: 20px; font-size: 14px; color: #888;">
                            ï¼ˆ3Dæ•ˆæœåœ¨å½“å‰è®¾å¤‡ä¸å¯ç”¨ï¼‰
                        </div>
                    </div>
                `;
            }
            
        })();
    </script>
</body>
</html>
